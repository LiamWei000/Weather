<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weather Pro</title>

<style>
*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:system-ui,-apple-system,sans-serif;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
  transition:0.4s ease;
}

body.day{
  background:linear-gradient(135deg,#3b82f6,#0ea5e9);
  color:#fff;
}

body.night{
  background:linear-gradient(135deg,#0f172a,#1e293b);
  color:#fff;
}

.container{
  width:100%;
  max-width:520px;
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(20px);
  border-radius:20px;
  padding:30px;
  box-shadow:0 10px 40px rgba(0,0,0,0.4);
}

h1{text-align:center;margin-bottom:20px}

.search{
  display:flex;
  gap:10px;
  margin-bottom:15px;
}

input{
  flex:1;
  padding:10px;
  border-radius:10px;
  border:none;
  outline:none;
}

button{
  padding:10px 14px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-weight:bold;
}

.controls{
  display:flex;
  justify-content:space-between;
  margin-bottom:15px;
}

.weather-main{
  text-align:center;
  margin-bottom:20px;
}

.icon{
  font-size:48px;
}

.temp{
  font-size:48px;
  font-weight:bold;
}

.desc{opacity:0.9}

.forecast{
  display:flex;
  gap:10px;
}

.day-card{
  flex:1;
  background:rgba(255,255,255,0.12);
  padding:10px;
  border-radius:12px;
  text-align:center;
  font-size:14px;
}

.loading{text-align:center;opacity:0.7}
</style>
</head>
<body class="night">

<div class="container">
  <h1>Weather Pro</h1>

  <div class="search">
    <input id="city" placeholder="Enter city...">
    <button onclick="getWeather()">Search</button>
  </div>

  <div class="controls">
    <button onclick="detectLocation()">üìç Auto</button>
    <button onclick="toggleUnit()">Toggle ¬∞C/¬∞F</button>
  </div>

  <div id="weather">
    <div class="loading">Loading...</div>
  </div>
</div>

<script>
let unit = "C";

function getIcon(desc){
  desc = desc.toLowerCase();
  if(desc.includes("sun")) return "‚òÄÔ∏è";
  if(desc.includes("cloud")) return "‚òÅÔ∏è";
  if(desc.includes("rain")) return "üåß";
  if(desc.includes("storm")) return "‚õà";
  if(desc.includes("snow")) return "‚ùÑÔ∏è";
  return "üå§";
}

function setTheme(hour){
  if(hour >= 6 && hour < 18){
    document.body.className = "day";
  } else {
    document.body.className = "night";
  }
}

async function getWeather(city=null){
  const weatherDiv = document.getElementById("weather");
  const cityInput = document.getElementById("city");
  const location = city || cityInput.value || "Kraksaan";

  weatherDiv.innerHTML = `<div class="loading">Loading...</div>`;

  try{
    const res = await fetch(`https://wttr.in/${location}?format=j1`);
    const data = await res.json();

    const current = data.current_condition[0];
    const forecast = data.weather.slice(0,3);

    const temp = unit === "C" ? current.temp_C : current.temp_F;
    const icon = getIcon(current.weatherDesc[0].value);

    setTheme(new Date().getHours());

    weatherDiv.innerHTML = `
      <div class="weather-main">
        <div class="icon">${icon}</div>
        <div class="temp">${temp}¬∞${unit}</div>
        <div class="desc">${current.weatherDesc[0].value}</div>
        <div>${location}</div>
      </div>

      <div class="forecast">
        ${forecast.map(day=>`
          <div class="day-card">
            <div>${day.date}</div>
            <div>${unit==="C"?day.maxtempC:day.maxtempF}¬∞ / 
            ${unit==="C"?day.mintempC:day.mintempF}¬∞</div>
          </div>
        `).join("")}
      </div>
    `;

  }catch(e){
    weatherDiv.innerHTML = `<div class="loading">Failed to load weather</div>`;
  }
}

function toggleUnit(){
  unit = unit === "C" ? "F" : "C";
  getWeather();
}

function detectLocation(){
  if(navigator.geolocation){
    navigator.geolocation.getCurrentPosition(pos=>{
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;
      getWeather(`${lat},${lon}`);
    });
  }
}

getWeather();
</script>

</body>
</html>
